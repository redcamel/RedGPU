import{D as i,o as h,c as r,a2 as a,G as e,w as o}from"./chunks/framework.Dn9yU8Jh.js";const g=JSON.parse('{"title":"RedGPU Context","description":"Learn about RedGPUContext, the starting point and resource manager of the RedGPU engine.","frontmatter":{"title":"RedGPU Context","description":"Learn about RedGPUContext, the starting point and resource manager of the RedGPU engine.","order":2},"headers":[],"relativePath":"en/context/index.md","filePath":"en/context/index.md","lastUpdated":1769586579000}'),p={name:"en/context/index.md"},E=Object.assign(p,{setup(d){const t=`
    graph LR
        Init["Call RedGPU.init()"] -->|Async| Callback["onSuccess Callback"]
        Callback -->|Obtain Instance| Setup["Scene and View Setup"]
        Setup -->|Start Loop| Render["Renderer.start()"]
`;return(k,s)=>{const n=i("MermaidResponsive"),l=i("ClientOnly");return h(),r("div",null,[s[0]||(s[0]=a('<h1 id="redgpucontext" tabindex="-1">RedGPUContext <a class="header-anchor" href="#redgpucontext" aria-label="Permalink to &quot;RedGPUContext&quot;">​</a></h1><p><strong>RedGPUContext</strong> is the object that serves as the foundation for the RedGPU engine. It handles the complex WebGPU initialization process and plays a central role in creating and managing various resources such as textures and models.</p><h2 id="_1-role-and-main-functions" tabindex="-1">1. Role and Main Functions <a class="header-anchor" href="#_1-role-and-main-functions" aria-label="Permalink to &quot;1. Role and Main Functions&quot;">​</a></h2><p>RedGPUContext manages the overall state of the engine and provides the following functions:</p><ul><li><strong>Device Management</strong>: Maintains the connection and handles communication between the browser and GPU hardware.</li><li><strong>Resource Creation</strong>: All 3D objects, such as meshes, textures, and materials, are created through this context.</li><li><strong>Output Control</strong>: Connected to the HTML canvas element to display rendered results on the screen.</li></ul><h2 id="_2-initialization-process" tabindex="-1">2. Initialization Process <a class="header-anchor" href="#_2-initialization-process" aria-label="Permalink to &quot;2. Initialization Process&quot;">​</a></h2><p>To build the WebGPU environment, call the <code>RedGPU.init</code> function to asynchronously create the context.</p>',7)),e(l,null,{default:o(()=>[e(n,{definition:t})]),_:1}),s[1]||(s[1]=a(`<div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> RedGPU </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;dist/index.js&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> canvas</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> document.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getElementById</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;redgpu-canvas&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Request RedGPU initialization</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">RedGPU.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    canvas,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">redGPUContext</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Obtain RedGPUContext instance upon successful initialization.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;RedGPUContext ready:&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, redGPUContext);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Example: Create scene (context injection required)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> scene</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> RedGPU.Display.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Scene</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">failReason</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Handle initialization failure (e.g., WebGPU not supported)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Initialization failed:&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, failReason);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><h2 id="_3-core-interface" tabindex="-1">3. Core Interface <a class="header-anchor" href="#_3-core-interface" aria-label="Permalink to &quot;3. Core Interface&quot;">​</a></h2><h3 id="_3-1-view-registration-and-management" tabindex="-1">3.1 View Registration and Management <a class="header-anchor" href="#_3-1-view-registration-and-management" aria-label="Permalink to &quot;3.1 View Registration and Management&quot;">​</a></h3><p>Manages the list of <strong>Views</strong> (View3D) that determine what to draw on the screen. Created views must be registered in the context to be included in the actual rendering pipeline.</p><table tabindex="0"><thead><tr><th style="text-align:left;">Method</th><th style="text-align:left;">Description</th></tr></thead><tbody><tr><td style="text-align:left;"><code>addView(view)</code></td><td style="text-align:left;">Registers a view to render.</td></tr><tr><td style="text-align:left;"><code>removeView(view)</code></td><td style="text-align:left;">Removes a registered view.</td></tr><tr><td style="text-align:left;"><code>viewList</code></td><td style="text-align:left;">Returns a list of all currently registered views.</td></tr></tbody></table><h3 id="_3-2-automatic-canvas-size-optimization" tabindex="-1">3.2 Automatic Canvas Size Optimization <a class="header-anchor" href="#_3-2-automatic-canvas-size-optimization" aria-label="Permalink to &quot;3.2 Automatic Canvas Size Optimization&quot;">​</a></h3><p>RedGPU automatically detects changes in the <strong>Layout Size</strong> of the canvas element. If the browser window size changes or the area occupied by the canvas changes due to CSS layout, the engine automatically resets the rendering resolution accordingly.</p><p>In this process, you can define an <code>onResize</code> callback to execute additional logic at the time of size change.</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Define callback to be called when size changes</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">redGPUContext.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">onResize</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">width</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">height</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`Canvas size changed: \${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">width</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}x\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">height</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Perform UI repositioning or camera property adjustments.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><h2 id="_4-necessity-of-context-injection" tabindex="-1">4. Necessity of Context Injection <a class="header-anchor" href="#_4-necessity-of-context-injection" aria-label="Permalink to &quot;4. Necessity of Context Injection&quot;">​</a></h2><p>Almost all objects in RedGPU require <code>redGPUContext</code> as the first argument upon creation.</p><p>This is because each object needs to know <strong>&quot;on which GPU device to create data&quot;</strong> to use GPU memory. By passing the context, the engine can correctly link objects with actual hardware resources.</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// [O] Correct way: Pass context upon creation.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> material</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> RedGPU.Material.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ColorMaterial</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(redGPUContext);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// [X] Incorrect way: An error occurs if context is missing.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// const material = new RedGPU.Material.ColorMaterial();</span></span></code></pre></div><h2 id="key-summary" tabindex="-1">Key Summary <a class="header-anchor" href="#key-summary" aria-label="Permalink to &quot;Key Summary&quot;">​</a></h2><ul><li><strong>Engine Starting Point</strong>: A required object created asynchronously via <code>RedGPU.init</code>.</li><li><strong>Required Argument</strong>: Must be injected when creating all graphic objects such as meshes or materials.</li><li><strong>Integrated Manager</strong>: Manages GPU device, canvas, and rendering views as one.</li></ul><h2 id="next-steps" tabindex="-1">Next Steps <a class="header-anchor" href="#next-steps" aria-label="Permalink to &quot;Next Steps&quot;">​</a></h2><p>You are ready to run the engine through RedGPUContext. But the screen is still empty.</p><p>Now it&#39;s time to learn how to compose the actual 3D world by placing a <strong>Camera</strong> on the empty canvas and defining a <strong>Scene</strong> to hold objects.</p><ul><li><strong><a href="./../view-system/">View System</a></strong></li></ul>`,19))])}}});export{g as __pageData,E as default};
